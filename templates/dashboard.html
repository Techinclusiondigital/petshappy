<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Control</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

</head>
<body>

<header>
    <h1 class="bienvenido">🐾 Bienvenid@, {{ current_user.nombre_usuario }}</h1>
</header>

<button class="menu-toggle" onclick="toggleMenu()">☰ Menú</button>

<nav>
    <ul class="nav-links" id="navMenu">
        <li><a href="/registrar">Registrar mascota</a></li>
        <li><a href="/mascotas">Ver mascotas</a></li>
        <li><a href="/buscar-mascota">Buscar mascota</a></li>
        <li><a href="/cita">Registrar cita</a></li>
        <li><a href="/agenda">Agenda</a></li>
        <li><a href="/logout">Cerrar sesión</a></li>
    </ul>
</nav>

<script>
    function toggleMenu() {
        const menu = document.getElementById("navMenu");
        menu.classList.toggle("show");
    }
</script>
<h1>📅 Agenda de Citas</h1>

<div class="agenda-container">

    <a href="/cita" class="boton">➕ Agendar nueva cita</a>

    {% for fecha, nombre_dia, bloques in agenda %}
        <h2>🗓️ {{ nombre_dia|capitalize }} {{ fecha.strftime("%d/%m/%Y") }}</h2>
        <ul>
            {% for bloque in bloques %}
            <li>
                {% if bloque.enlace %}
                    <a href="{{ bloque.enlace }}">{{ bloque.texto }}</a>
                {% else %}
                    <strong class="ocupado">{{ bloque.texto }}</strong>

                    {% if bloque.cita_id %}
                        {% if bloque.metodo_pago %}
                            {% if bloque.metodo_pago == 'efectivo' %} 💵
                            {% elif bloque.metodo_pago == 'tarjeta' %} 💳
                            {% endif %}
                        {% else %}
                            <form method="POST" action="/actualizar_pago/{{ bloque.cita_id }}" class="inline">
                                <select name="metodo_pago" onchange="this.form.submit()">
                                    <option value="">❓</option>
                                    <option value="efectivo">💵</option>
                                    <option value="tarjeta">💳</option>
                                </select>
                            </form>
                        {% endif %}

                        <form method="POST" action="/anular_cita/{{ bloque.cita_id }}" class="inline">
                            <button type="submit">❌ Anular</button>
                        </form>
                    {% endif %}
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    {% endfor %}

    <hr>
    <h2>📋 Arqueo del día</h2>
    <form method="GET" action="/arqueo">
        <button type="submit" class="boton">💰 Ver arqueo de caja</button>

    </form>

</div>

</body>
</html>


