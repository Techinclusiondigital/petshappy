{% extends "base.html" %}

{% block content %}
<h1>ğŸ“… Agenda de Citas</h1>
<style>
/* Ocultar flechas en Chrome, Safari y Edge */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* Ocultar flechas en Firefox */
input[type=number] {
    -moz-appearance: textfield;
}

/* Evitar que la rueda del ratÃ³n cambie el valor */
input[type=number]:focus {
    outline: none;
}




</style>
<div class="agenda-container">
    <a href="/cita" class="boton">â• Agendar nueva cita</a>

    {% for fecha, nombre_dia, bloques in agenda %}
        <h2>ğŸ—“ï¸ {{ nombre_dia|capitalize }} {{ fecha.strftime("%d/%m/%Y") }}</h2>
        <ul>
            {% for bloque in bloques %}
            <li>
                {% if bloque.enlace %}
                    <a href="{{ bloque.enlace }}">{{ bloque.texto }}</a>
                {% else %}
                    <strong class="ocupado">{{ bloque.texto }}</strong>

                    {% if bloque.cita_id %}
                        {% if bloque.metodo_pago %}
                            {% if bloque.metodo_pago == 'efectivo' %} ğŸ’µ
                            {% elif bloque.metodo_pago == 'tarjeta' %} ğŸ’³
                            {% endif %}
                        {% else %}
                        <form method="POST" action="/actualizar_pago/{{ bloque.cita_id }}" class="inline">
                            <!-- MÃ©todo de pago -->
                            <select name="metodo_pago">
                                <option value="">â“</option>
                                <option value="efectivo">ğŸ’µ</option>
                                <option value="tarjeta">ğŸ’³</option>
                            </select>
                        
                            <!-- Precio -->
                            <input type="number" name="precio" placeholder="â‚¬" step="0.01" style="width: 70px;" required>
                        
                            <!-- BotÃ³n guardar -->
                            <button type="submit">ğŸ’¾</button>
                        </form>
                        
                                
                        {% endif %}

                        <form method="POST" action="/anular_cita/{{ bloque.cita_id }}" class="inline">
                            <button type="submit">âŒ Anular</button>
                        </form>
                    {% endif %}
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    {% endfor %}

    <hr>
    <h2>ğŸ“‹ Arqueo del dÃ­a</h2>
    <form method="GET" action="/arqueo">
        <button type="submit">ğŸ’° Ver arqueo de caja</button>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("input[type='number']").forEach(input => {
            input.addEventListener("wheel", function (e) {
                e.preventDefault();
            });
        });
    });
    </script>
    
{% endblock %}

